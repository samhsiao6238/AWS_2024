# Elastic Beanstalk

<br>

## 概述

1. AWS Elastic Beanstalk 是一個簡化部署和管理應用程序的服務，開發者只需上傳代碼，Elastic Beanstalk 會自動處理容量佈建、負載均衡、縮放以及應用程序的健康狀態監控。

<br>

2. 支援多種編程語言和應用程序平台，如 Java、.NET、Node.js、Python、Ruby、PHP、Go 和 Docker。

<br>

## 應用

1. 部署和測試 Web 應用程序。

<br>

2. 部署基於微服務架構的應用程序。

<br>

## 收費

_Elastic Beanstalk 本身不收取額外費用，但您需要支付所使用的 AWS 資源費用_

![](images/img_02.png)

<br>

1. EC2：計算資源的使用費。

<br>

2. S3：存儲資源的使用費。

<br>

3. Elastic Load Balancing：負載均衡器的使用費。

<br>

4. RDS：數據庫資源的使用費。

## 配置 IAM 角色

1. 登入 AWS 管理控制台，進入 `IAM`，創建一個新的角色。

    ![](images/img_21.png)

<br>

2. 選擇 `AWS 服務`。

    ![](images/img_22.png)

<br>

3. 然後選擇 `Elastic Beanstalk`。

    ![](images/img_23.png)

<br>

4. 選擇 `Elastic Beanstalk - Customizable`，點擊 `下一步`。

    ![](images/img_24.png)

<br>

5. 預設有兩個政策 `AWSElasticBeanstalkEnhancedHealth`、`AWSElasticBeanstalkService`，先點擊 `下一步`。

    ![](images/img_28.png)

<br>

6. 自定義角色名稱 `MyAWSServiceRoleForElasticBeanstalk`，因為角色名稱的前綴 `AWSServiceRoleFor` 只使用給 AWS Service Linked Roles。

    ![](images/img_26.png)

<br>

7. 建立角色。

    ![](images/img_25.png)

<br>

8. 完成後，點擊角色進入進行 `新增許可`，並選擇 `連接許可`。

    ![](images/img_29.png)

<br>

9. 搜尋 `AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy`，勾選後點擊 `新增許可`。

    ![](images/img_30.png)

<br>

## 建立 PHP 腳本

1. 先編輯一個腳本待用。

    ```bash
    cd ~/Downloads && touch index.php && code index.php
    ```

<br>

2. 編輯內容如下。

    ```html
    <html>
        <head>
            <title>PHP Test</title>
        </head>
        <body>
            <?php echo '<p>PHP 測試腳本</p>'; ?>
        </body>
    </html>
    ```

<br>

3. 壓縮檔案並顯示檢查。

    ```bash
    zip index.zip index.php && ls -l index.zip
    ```

    ![](images/img_06.png)

<br>

## 建立 Beanstalk 應用

4. 點擊右上角的 `建立應用程式`。

    ![](images/img_01.png)

<br>

5. 自訂名稱 `_PHP_Demo_`。

    ![](images/img_03.png)

<br>

6. `平台` 選擇 `PHP`，其餘使用自動選取的即可。

    ![](images/img_04.png)

<br>

7. 上傳程式碼。

    ![](images/img_05.png)

<br>

8. 選擇從 `本機檔案` 上傳。

    ![](images/img_09.png)

<br>

9. 選取前面步驟壓縮的 `index.zip` 檔案。

    ![](images/img_10.png)

<br>

10. 自訂版本標籤 `v01`。

    ![](images/img_07.png)

<br>

11. `組態預設 Presets` 部分勾選 `單一執行個體`。

    ![](images/img_11.png)

<br>

12. 下一步。

    ![](images/img_08.png)

<br>

## 服務存取

1. 在 `服務存取`設定，選擇 `使用現有的服務角色`，就是在前面建立的角色。

    ![](images/img_12.png)

<br>

2. EC2 金鑰組，選擇 `MyKey01`，然後 `下一步`。

    ![](images/img_27.png)

<br>

3. 虛擬私有雲端 VPC 有一個選項可選。

    ![](images/img_13.png)

<br>

4. 在 `執行個體設定`中，勾選 `已啟用` 公用 IP 地址，並選擇子網路 `ap-southeast-1a`。

    ![](images/img_14.png)

<br>

5. 資料庫選 1b、1c。

    ![](images/img_15.png)

<br>

6. 勾選 `啟用資料庫`。

    ![](images/img_16.png)

<br>

7. 設定使用者名稱、密碼。

    ![](images/img_18.png)

<br>

8. 點擊三次 `下一步`。

    ![](images/img_17.png)

<br>

9. 點擊 `提交`。

    ![](images/img_19.png)

<br>

10. 接著顯示啟動環境，要等幾分鐘；真的得等幾分鐘。

    ![](images/img_20.png)

<br>

## 事件

1. 在 `Elastic Beanstalk` 啟動過程中，設定畫面最下方會有事件日誌可以查看。

![](images/img_31.png)