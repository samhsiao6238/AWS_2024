# Task 12：測試完整解決方案

_測試已完成的 `POC（概念驗證）` 解決方案，確保其能夠正常運行，並驗證其處理 2 月份數據的功能。_

<br>

## 測試最新的工作流程結果

1. 進入 Step Functions 主控台啟動狀態機 `WorkflowPOC`，點擊右上角 `Execute` 進行測試，並將測試名稱設為 `TaskTwelveTest`，然後點擊 `Start execution`。

    ![](images/img_163.png)

<br>

2. 完成的工作流程如下圖；務必確認所有圖框都已變成綠色，尤其是 `Check All Tables`。

    ![](images/img_164.png)

<br>

3. 在 Graph inspector 區段中，可以拖曳位於頁面底部的橫條來調整圖表大小，以便更清晰地查看工作流程圖。

<br>

## 驗證迭代器是否正常工作

1. 在 `Graph view` 中，選擇 `CheckTable` 步驟。

<br>

2. 頁面頂部會出現兩個下拉選單，分別為 Iteration status 和 Index。預設情況下，第一個迭代（索引值為 0）被選中。

<br>

3. 在右側的 Details 面板中，確認該次迭代已成功完成。

<br>

4. 將 Index 更改為 1，並確認該次迭代也已成功完成。

<br>

5. 重複上述步驟，確認索引值為 2、3 和 4 的迭代均已成功。

<br>

6. 將 Index 值切換回 0，並選擇 Step input 頁籤。

<br>

7. 確認顯示的 JSON 代碼是否如下圖所示，其中 `VarCharValue` 的值應設為 `nyctaxi_lookup_csv`。

<br>

8. 保持在 Step input 頁籤，變更索引值，直到 `VarCharValue` 的值變為 `yellowtaxi_data_parquet`。

<br>

9. 在圖表中，選擇 `Insert New Parquet Data` 步驟，然後切換到 Step output 頁籤。

<br>

10. 在此處可以查看建立檢視表的查詢以及其他步驟的執行細節。

<br>

## 在 Athena 控制台中進行測試

1. 進入 Athena 主控台，打開查詢編輯器，並確保資料庫選擇為 `nyctaxidb`。

    ![](images/img_165.png)

<br>

2. 在 `Views` 區段中，選擇 `yellowtaxi_data_vw` 檢視表右側的三點圖標，然後選擇 Preview View。

    ![](images/img_166.png)

<br>

3. 預覽結果的前 10 條記錄應顯示出來，並確認檢視表現在掃描包含 2 月數據的數據集。

    ![](images/img_167.png)

<br>

4. 為驗證 2 月的計程車數據已包含在數據集中，執行以下查詢。

    ```sql
    SELECT * FROM "nyctaxidb"."yellowtaxi_data_vw" WHERE pickup_month = '02'
    ```

<br>

5. 結果共計 `259` 條記錄。

    ![](images/img_168.png)

<br>

6. 會顯示前 `100` 條記錄，至此可確認 `2 月` 數據已成功納入查詢結果，成功測試了 ETL 工作流程。

    ![](images/img_169.png)

<br>

## 完成

1. 通過。

    ![](images/img_170.png)

<br>

2. 耗時。

    ![](images/img_171.png)

<br>

___

_END_