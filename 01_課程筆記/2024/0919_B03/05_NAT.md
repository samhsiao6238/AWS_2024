# NAT

_Network Address Translation，網路位址轉換_

<br>

## 說明

1. `NAT` 是一種用來修改封包 IP 位址的技術，應用於內部私有網路與外部公有網路之間的 `IP 位址轉換`，主要目的在於 `節省公有 IP 位址` 並 `提高網路安全性`。

2. 在 AWS 中，`NAT Gateway` 或 `NAT Instance` 用於讓位於私有子網中的 EC2 實例能夠發起連線至網際網路或其他 AWS 服務，並阻止外部網路直接進入這些實例，確保內部資源能安全存取外部服務而不暴露在公用網路上。

<br>

## 基本功能

1. NAT 允許內部私有網路中的多台設備共用少量的公有 IP 位址進行外部通信。

2. 當內部設備發送資料到外部網路時，NAT 會將私有 IP 位址轉換為公有 IP 位址，並在收到外部回應時，將公有 IP 位址轉回私有 IP 位址，使內部設備正確接收資料。

<br>

## 工作方式

1. 當內部設備試圖訪問外部網路時，NAT 會記錄該設備的私有 IP 位址及其連線請求（如源 IP、目標 IP 和埠號）。

<br>

2. NAT 會將私有 IP 替換為路由器的公有 IP，並發送封包到外部網路。

<br>

3. 當外部回應到達 NAT 路由器時，NAT 會根據記錄的映射表將公有 IP 替換回對應的私有 IP，並將封包回傳至內部設備。

<br>

## 類型

1. 靜態 NAT (Static NAT)：將內部私有 IP 靜態映射到固定的公有 IP，通常用於需要外部訪問的內部設備（如伺服器）。

<br>

2. 動態 NAT (Dynamic NAT)：動態映射私有 IP 至一組預定義的公有 IP，根據可用性分配。

<br>

3. PAT (Port Address Translation)：允許多台內部設備共用一個公有 IP，通過不同的埠號區分每個連線，是家庭路由器中常見的 NAT 形式。

<br>

## 優點

1. 減少公有 IP 位址需求，允許多台內部設備共用少量公有 IP。

<br>

2. 隱藏內部私有網路架構與 IP 位址，增加網路安全性。

<br>

3. 雖然 NAT 本身不是防火牆，但阻止了外部網路直接訪問內部設備，從而提高了安全性。

<br>

## 缺點

1. 建立 NAT 映射表會消耗路由器資源。

<br>

2. 某些需要端到端連線的應用（如 P2P、VoIP）在使用 NAT 時可能遇到連線問題，因為 NAT 改變了源 IP 位址。

<br>

___

_END_